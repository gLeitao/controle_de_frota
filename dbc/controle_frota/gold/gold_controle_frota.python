{"version":"NotebookV1","origId":4425122281340187,"name":"gold_controle_frota","language":"python","commands":[{"version":"CommandV1","origId":2409245436832676,"guid":"f21677b9-985a-4ca9-ad49-3d6ac7397acf","subtype":"command","commandType":"auto","position":13.0,"command":"df_frota_consolidado = df_tempo_frota.groupBy('poi', 'placa', 'status').\\\n                       agg(F.when((F.col('status') == 0), F.sum(F.col('tempo'))).alias('tempo_parado'), F.sum(F.col('tempo')).alias('tempo_total')).\\\n                       groupBy('poi', 'placa').\\\n                       agg(F.sum('tempo_parado').alias('tempo_parado'), F.sum('tempo_total').alias('tempo_total')).withColumn('nivel', F.lit(1))\n\ndf_frota_consolidado.show()","commandVersion":154,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+--------+------------+-----------+-----+\n|     poi|   placa|tempo_parado|tempo_total|nivel|\n+--------+--------+------------+-----------+-----+\n|PONTO 24| CAR0012|      342764|     344368|    1|\n| PONTO 1|TESTE001|         471|      10255|    1|\n| PONTO 2|TESTE001|        2044|       5917|    1|\n|PONTO 24|TESTE001|      653235|     675703|    1|\n+--------+--------+------------+-----------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_frota_consolidado","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"poi","nullable":true,"type":"string"},{"metadata":{},"name":"placa","nullable":true,"type":"string"},{"metadata":{},"name":"tempo_parado","nullable":true,"type":"long"},{"metadata":{},"name":"tempo_total","nullable":true,"type":"long"},{"metadata":{},"name":"nivel","nullable":false,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1623897799081,"submitTime":1623897799066,"finishTime":1623897800043,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"79c1f876-b0ad-4a95-a86c-992c80468db5"},{"version":"CommandV1","origId":2409245436832680,"guid":"f238a913-209c-4736-8b95-3467e6008c7d","subtype":"command","commandType":"auto","position":17.0,"command":"df_poi_consolidado = df_frota_consolidada.groupBy('poi').agg(F.sum('tempo').alias('tempo_parado')).withColumn('nivel', F.lit(2))\ndf_poi_consolidado = df_poi_consolidado.select('poi', F.lit('').alias('placa'), 'tempo_parado', F.lit('').alias('tempo_total'), 'nivel')\ndf_poi_consolidado.show()","commandVersion":256,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+-----+------------+-----------+-----+\n|     poi|placa|tempo_parado|tempo_total|nivel|\n+--------+-----+------------+-----------+-----+\n| PONTO 1|     |       10255|           |    2|\n| PONTO 2|     |        5917|           |    2|\n|PONTO 24|     |     1020071|           |    2|\n+--------+-----+------------+-----------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_poi_consolidado","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"poi","nullable":true,"type":"string"},{"metadata":{},"name":"placa","nullable":false,"type":"string"},{"metadata":{},"name":"tempo_parado","nullable":true,"type":"long"},{"metadata":{},"name":"tempo_total","nullable":false,"type":"string"},{"metadata":{},"name":"nivel","nullable":false,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1623897812624,"submitTime":1623897812610,"finishTime":1623897813959,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"17f9b86a-06b3-4a0a-a160-b20f8ecb56e8"},{"version":"CommandV1","origId":4425122281340188,"guid":"18114d09-2077-41ac-b718-d51b7eb447c9","subtype":"command","commandType":"auto","position":1.0,"command":"df_frota = spark.read.format(\"delta\").load(\"dbfs:/FileStore/tables/batch/silver/frota\")\ndf_frota.sort('placa', 'data_posicao', 'poi')\ndf_frota.show(5)","commandVersion":33,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+-------------------+----------+-----------+-----------+-------+--------+------+\n|   placa|       data_posicao|velocidade|  longitude|   latitude|ignicao|     poi|status|\n+--------+-------------------+----------+-----------+-----------+-------+--------+------+\n|TESTE001|2018-12-12 00:04:03|         0| -51.469891|-25.3649141|  false|PONTO 24|     0|\n|TESTE001|2018-12-12 00:34:06|         0|-51.4699098|-25.3649175|  false|PONTO 24|     0|\n|TESTE001|2018-12-12 01:04:09|         0|-51.4699588|-25.3649551|  false|PONTO 24|     0|\n|TESTE001|2018-12-12 01:34:12|         0|-51.4698871|-25.3649138|  false|PONTO 24|     0|\n|TESTE001|2018-12-12 02:04:15|         0|-51.4699223| -25.364885|  false|PONTO 24|     0|\n+--------+-------------------+----------+-----------+-----------+-------+--------+------+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_frota","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"placa","nullable":true,"type":"string"},{"metadata":{},"name":"data_posicao","nullable":true,"type":"timestamp"},{"metadata":{},"name":"velocidade","nullable":true,"type":"integer"},{"metadata":{},"name":"longitude","nullable":true,"type":"string"},{"metadata":{},"name":"latitude","nullable":true,"type":"string"},{"metadata":{},"name":"ignicao","nullable":true,"type":"string"},{"metadata":{},"name":"poi","nullable":true,"type":"string"},{"metadata":{},"name":"status","nullable":true,"type":"integer"}],"type":"struct"},"tableIdentifier":"dbfs:/FileStore/tables/batch/silver/frota"}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1623897781113,"submitTime":1623897781098,"finishTime":1623897783157,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"d616d8c6-da40-46f9-a885-935ec4f3dd52"},{"version":"CommandV1","origId":4425122281340189,"guid":"57f78393-f27e-46b6-84e8-2aeedead2dfa","subtype":"command","commandType":"auto","position":2.0,"command":"df_frota.registerTempTable(\"vw_frota\")","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1623897785289,"submitTime":1623897785268,"finishTime":1623897785339,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b35d7e53-8cee-4821-b8c6-914989aa32ac"},{"version":"CommandV1","origId":4425122281340190,"guid":"c7b78273-31cf-4685-acfa-ba171c8b31d8","subtype":"command","commandType":"auto","position":0.25,"command":"from pyspark.sql import functions as F\nfrom pyspark.sql import DataFrame\nfrom functools import reduce","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1623897779826,"submitTime":1623897779812,"finishTime":1623897779851,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"00813db2-e2cc-4a0c-af0a-e9e4cc1743b2"},{"version":"CommandV1","origId":4425122281340194,"guid":"4f8c0c83-26bd-40ce-9fb7-69951cd8da5a","subtype":"command","commandType":"auto","position":6.0,"command":"%sql \n\nwith data_diff_time as (\nSELECT placa,\n       poi, \n       data_posicao,\n       status,\n       lag (data_posicao) over (partition by placa, poi order by data_posicao asc) as data_diff\n  from vw_frota \n)\nSELECT placa,\n       poi, \n       status,\n       round(sum(nvl(((unix_timestamp(data_posicao) - unix_timestamp(data_diff)) ),0)),2)  as tempo\n  from data_diff_time \n  where poi != ''\ngroup by placa,\n         poi,\n         status","commandVersion":128,"state":"finished","results":{"type":"table","data":[["CAR0012","PONTO 24",0,342764],["CAR0012","PONTO 24",1,1604],["TESTE001","PONTO 1",1,9784],["TESTE001","PONTO 1",0,471],["TESTE001","PONTO 2",1,3873],["TESTE001","PONTO 2",0,2044],["TESTE001","PONTO 24",0,653235],["TESTE001","PONTO 24",1,22468]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"placa","type":"\"string\"","metadata":"{}"},{"name":"poi","type":"\"string\"","metadata":"{}"},{"name":"status","type":"\"integer\"","metadata":"{}"},{"name":"tempo","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1623897787265,"submitTime":1623897787250,"finishTime":1623897788195,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"747","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"c7537189-73cd-4b5d-9eba-3901dd163a5b"},{"version":"CommandV1","origId":4425122281340205,"guid":"5ffade7a-af8e-44aa-a0f9-8952f0f17210","subtype":"command","commandType":"auto","position":9.0,"command":"df_tempo_frota = spark.sql(\"\"\" \n                                 with data_diff_time as (SELECT  placa,\n                                                                 poi, \n                                                                 data_posicao,\n                                                                 status,\n                                                                 lag (data_posicao) over (partition by placa, poi order by data_posicao asc) as data_diff\n                                                            from vw_frota \n                                                         )\n                                  SELECT placa,\n                                         poi, \n                                         status,\n                                         round(sum(nvl(((unix_timestamp(data_posicao) - unix_timestamp(data_diff)) ),0)),2)  as tempo\n                                    from data_diff_time \n                                    where poi != ''\n                                  group by placa,\n                                           poi,\n                                           status\n                                 \"\"\")\n\ndf_tempo_frota.show(5)","commandVersion":30,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+--------+------+------+\n|   placa|     poi|status| tempo|\n+--------+--------+------+------+\n| CAR0012|PONTO 24|     0|342764|\n| CAR0012|PONTO 24|     1|  1604|\n|TESTE001| PONTO 1|     1|  9784|\n|TESTE001| PONTO 1|     0|   471|\n|TESTE001| PONTO 2|     1|  3873|\n+--------+--------+------+------+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_tempo_frota","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"placa","nullable":true,"type":"string"},{"metadata":{},"name":"poi","nullable":true,"type":"string"},{"metadata":{},"name":"status","nullable":true,"type":"integer"},{"metadata":{},"name":"tempo","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1623897790217,"submitTime":1623897790198,"finishTime":1623897791158,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"b44eb6f0-5484-4db7-8255-8639f572073d"},{"version":"CommandV1","origId":2676121430804984,"guid":"29a41d01-f940-4cab-b5f5-1dbbe430c7b0","subtype":"command","commandType":"auto","position":21.0,"command":"dfs = [df_frota_consolidado, df_poi_consolidado, df_placa_consolidado]\ndf_resultado = reduce(DataFrame.unionAll, dfs)\ndf_resultado.show()","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+--------+------------+-----------+-----+\n|     poi|   placa|tempo_parado|tempo_total|nivel|\n+--------+--------+------------+-----------+-----+\n|PONTO 24| CAR0012|      342764|     344368|    1|\n| PONTO 1|TESTE001|         471|      10255|    1|\n| PONTO 2|TESTE001|        2044|       5917|    1|\n|PONTO 24|TESTE001|      653235|     675703|    1|\n| PONTO 1|        |       10255|           |    2|\n| PONTO 2|        |        5917|           |    2|\n|PONTO 24|        |     1020071|           |    2|\n|        |TESTE001|      691875|           |    3|\n|        | CAR0012|      344368|           |    3|\n+--------+--------+------------+-----------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_resultado","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"poi","nullable":true,"type":"string"},{"metadata":{},"name":"placa","nullable":true,"type":"string"},{"metadata":{},"name":"tempo_parado","nullable":true,"type":"long"},{"metadata":{},"name":"tempo_total","nullable":true,"type":"string"},{"metadata":{},"name":"nivel","nullable":false,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1623897819336,"submitTime":1623897819323,"finishTime":1623897821698,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"593c52a2-f57c-4ad0-9bae-53f07c8b39ae"},{"version":"CommandV1","origId":2676121430804985,"guid":"bd25143a-82b5-44eb-bc08-ea78d822a9d7","subtype":"command","commandType":"auto","position":17.5,"command":"df_placa_consolidado = df_frota_consolidada.groupBy('placa').agg(F.sum('tempo').alias('tempo_parado')).withColumn('nivel', F.lit(3))\ndf_placa_consolidado = df_placa_consolidado.select(F.lit('').alias('poi'), 'placa', 'tempo_parado', F.lit('').alias('tempo_total'), 'nivel')\ndf_placa_consolidado.show()","commandVersion":30,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+--------+------------+-----------+-----+\n|poi|   placa|tempo_parado|tempo_total|nivel|\n+---+--------+------------+-----------+-----+\n|   |TESTE001|      691875|           |    3|\n|   | CAR0012|      344368|           |    3|\n+---+--------+------------+-----------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_placa_consolidado","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"poi","nullable":false,"type":"string"},{"metadata":{},"name":"placa","nullable":true,"type":"string"},{"metadata":{},"name":"tempo_parado","nullable":true,"type":"long"},{"metadata":{},"name":"tempo_total","nullable":false,"type":"string"},{"metadata":{},"name":"nivel","nullable":false,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1623897815789,"submitTime":1623897815767,"finishTime":1623897817663,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"2c0b40cb-a6ae-4fca-b93f-83f433e86b16"},{"version":"CommandV1","origId":2676121430804986,"guid":"6dadf12f-30df-44a9-a42f-94a153bd946e","subtype":"command","commandType":"auto","position":22.0,"command":"df_resultado.write.mode(\"overwrite\").format(\"delta\").save(\"dbfs:/FileStore/tables/batch/gold/frota/\")","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1623897864364,"submitTime":1623897864348,"finishTime":1623897878281,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"acdb6b5f-ac0a-4098-b631-52baf7c259c2"},{"version":"CommandV1","origId":2676121430804987,"guid":"c2740acc-9389-401f-b125-e5453357939d","subtype":"command","commandType":"auto","position":23.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"84194457-fbbd-4e61-aafd-ef32ce2a28b8"}],"dashboards":[],"guid":"b86288e0-9014-4c03-b93c-cc39794c2290","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2}}